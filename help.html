<!DOCTYPE html>
<html>
<head>

<meta charset="utf-8">
<title>LyricsTTE Web Help</title>

<style>
    body{
        color: black;
        background-color: white;
    }
    section{
        border-bottom: black 2px solid;
    }
    h2{
        margin :4px 0px 0px;
    }
    h3{
        margin :4px 0px 0px;
    }
    h4{
        margin :2px 0px 0px;
    }
    ol{
        margin: 2px 0px;
    }

   table {
        border: 2px solid black;
        border-collapse: collapse;
        margin: 0px 2px 4px;
    }
    table th
    {
        text-align: center;
        border: 1px solid black;
        background-color: rgb(192, 255, 255);
    }
    table td
    {
        text-align: left;
        border: 1px solid black;
        padding-left: 4px;
    }
</style>

</head>
<body>
    <section>
    <h2>基本的な流れ</h2>
    <ol>
    <li>[TextEdit]でルビを付けた歌詞を貼り付けます。ついでに音楽ファイルもドロップしておきます。</li>
    <li>[TagPoint]で「自動チェック」を押し、必要であれば手動でタグマーカーポイントを修正します。</li>
    <li>[TagStamp]で音楽を再生し、歌に合わせてスペースキーを押しまくります。俺の場合再生速度×0.5でやっとです</li>
    <li>[TTTest]は現状やっつけおまけ機能です。あまり当てにしてくれるな。</li>
    </ol>
    </section>

    <section>
        <h2>操作説明</h2>
        <div>
        <table>
            <caption>キー入力操作</caption>
            <thead>
                <tr><th>key</th><th>Point</th><th>Stamp</th></tr>
            </thead>
            <tbody>
                <tr><td>W ↑</td><td>現在行を上に</td><td>現在行を上にして再生位置を合わせる</td></tr>
                <tr><td>S ↓</td><td>現在行を下に</td><td>現在行を下に再生位置を合わせる</td></tr>
                <tr><td>A ←</td><td>前の位置に移動</td><td>前のマーカーに移動</td></tr>
                <tr><td>D →</td><td>次の位置に移動</td><td>次のマーカーに移動</td></tr>
                <tr><td>Space Enter</td><td>マーカーをセット/解除</td><td>マーカーに現再生時間をセット</td></tr>
                <tr><td>ctlr+<br>Space Enter</td><td>keyupマーカーをセット/解除</td><td>何もしない</td></tr>
                <tr><td>x</td><td>何もしない</td><td>play/pause</td></tr>
                <tr><td>Z / C</td><td>何もしない</td><td>一秒戻す/進める</td></tr>
            </tbody>
        </table>
        </div>
    </section>
    <section>
    <h2>細かい説明</h2>

    <h3>オーディオ操作</h3>
    ブラウザ依存のaudioタグによるコントロールパネル<br>
    <h3>再生速度</h3>
    audioの機能を使ったplaybackRate変更。とりあえず実用範囲内と思われる0.25～2.00を0.25刻みで。<br>
    <h3>表示倍率</h3>
    波形表示の倍率。数値は1秒の波形を表示するのに使うpixel幅。PixelsPerSecond?<br>
    <h3>？</h3>
    この画面です<br>
    
    <h3>波形表示</h3>
    読み込んだオーディオファイルの波形です。<br>
    ドラッグの左右移動でaudioの再生位置を動かせます<br>
    サイズ変更可能で、真っ黒で見えないけど右下にresizeハンドルがあります<br>
    
    <h3>ドラッグアンドドロップ</h3>
    音声ファイルとテキストファイルを受け入れます。<br>
    ブラウザが判定したMIMEタイプが、"audio/*"なら音声ファイルとして読み込み、<br>
    "text/*"または拡張子が".lrc"か".kra"なら、テキスト（UTF8）として読み込みます。<br>
    複数ファイルの同時ドロップにも対応。<br>
    同時に同種のファイルがドロップした場合、最初に読み込みが成功したものが選ばれ以降の同種はスキップします。<br>
    音声ファイルの入力方法はこれしかありません。<br>
    
    
    <h3>タブっぽいの</h3>
    下の表示モードを切り替えます。<br>
    PointとStampから切り替わる時に、その時表示されていた内容がtextareaに反映され、<br>
    PointとStampに切り替わる時は、textareaの内容をもとに構築されます。

    <h3>TextEdit</h3>
    テキストを直接編集します<br>
    <h4>「オートセーブ」</h4>
    細かい動作説明をすると、タブを押してモード移動したときに、そのタブでの最新の内容をtextareaに書き出す処理をします。<br>
    その時にオートセーブにチェックが入っていれば、その内容をlocalStrageに保存します。<br>
    保存された内容は次にこのページを新しく開いたときに読み込まれます。<br>
    一度オートセーブされると、チェックを切ってもセーブされた内容は残り、毎回読み込まれます。<br>
    空の状態でオートセーブし、その後オートセーブを切ってタブ移動するとlocalStrageからキーも含めて削除できます。<br>

    <h4>「出力」</h4>
    他で使える（かもしれない）カラオケタイムタグ同期歌詞テキストに整形する画面に移行します。<br>
    TextEditの文字列はタイムタグが編集オプション付きの特殊仕様なので、そのままでは使えません。<br>
    ちなみに特殊仕様は"[00:00.00;nup]"という形式で";"の後の1文字ずつがそれぞれ何かしらのフラグを表します。<br>
    "u" keyUp キーアップマーカー （キーを離した時にタグを打つフラグ）<br>
    "p" Point マーカーポイント（基本全部のタグに付く。現状は特殊タグであることを目立たせるためにあるようなもの）<br>
    "n" Null 無効値 （タイムタグとして認識するために時間を[99:59.99]に設定しているが値に意味はない。フラグの代わりに[99:99.99]とかも考えたけど分かりにくいのでやめた）<br>

    <h3>TagPoint</h3>
    タグを打ち込む位置を示すマーカーをセットします<br>
    "["はキーダウン、"]"はキーアップを表すマーカーです。<br>
    既にタグとして時間が設定されているマーカーには色<span style="color: #AAAA44;background-color: black;">[]</span>が付きます。<br>
    クリックやカーソル移動で、行頭、行末、文字前、文字後、全ての位置を指定できます。<BR>
    自動チェックは文字に応じて適当にマーカーをセットします。既存のタイムタグの位置は関係ありません。<BR>
    タイムタグがあった場所にマークを設定せずにモードを移動した場合、その時間情報は消えます。

    <h3>TagStamp</h3>
    タグを打ち込みます<br>
    現在の位置が"["でキーを押したとき、"]"でキーを上げたとき、そのタグに再生時間が刻まれます。
    ここでも時間が設定されているマーカーには色<span style="color: #AAAA44;background-color: black;">[]</span>が付きます。<br>
    またこのモードの時のみ波形表示に開始時間が確定している文字が表示されます。（現在行と有効タグ前後1行ずつの3行分）
    
    <h3>TTTest</h3>
    テスト表示<br>
    @offsetに対応。（[offset:]にも対応）
    全てのタイムタグにoffsetの値を加算した扱いになります。（実際には再生時間のほうからoffset値を引いているんだけど）
    <ul>
        <li>絶対値が10未満の値の場合は秒単位と認識します（-0.3）</li>
        <li>絶対値が10以上の場合はミリ秒単位と認識します（-300）</li>
    </ul>
    カラオケタグの場合、ピッタリに打ち込んだつもりのタグは、0.3秒ぐらい早めないと遅く感じるのは俺だけ？
    発音された時点で、文字の真ん中ぐらいにワイプが来ているぐらいが理想なのか？（このテスト表示ワイプじゃないけど）
    </section>
    
</body>
</html>
